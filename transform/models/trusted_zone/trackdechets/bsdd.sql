{{ config(
  pre_hook = "{{ create_indexes_for_source(['readableid','createdat','updatedat','emittercompanysiret','transportercompanysiret','recipientcompanysiret']) }}"
) }}
SELECT
    id                                 AS "id",
    customid                           AS "custom_id",
    readableid                         AS "readable_id",
    createdat                          AS "created_at",
    updatedat                          AS "updated_at",
    status                             AS "status",
    isdeleted                          AS "is_deleted",
    ownerid                            AS "owner_id",
    wastedetailscode                   AS "waste_details_code",
    wastedetailsname                   AS "waste_details_name",
    wastedetailspop                    AS "waste_details_pop",
    wastedetailsisdangerous            AS "waste_details_is_dangerous",
    wastedetailsonucode                AS "waste_details_onu_code",
    wastedetailsquantity               AS "waste_details_quantity",
    wastedetailsquantitytype           AS "waste_details_quantity_type",
    wastedetailsconsistence            AS "waste_details_consistence",
    wastedetailspackaginginfos         AS "waste_details_packaging_infos",
    wastedetailsanalysisreferences     AS "waste_details_analysis_references",
    wastedetailslandidentifiers        AS "waste_details_land_identifiers",
    wastedetailsparcelnumbers          AS "waste_details_parcel_numbers",
    wasteacceptationstatus             AS "waste_acceptation_status",
    wasterefusalreason                 AS "waste_refusal_reason",
    emittercompanysiret                AS "emitter_company_siret",
    emittercompanyname                 AS "emitter_company_name",
    emittertype                        AS "emitter_type",
    emittercompanyaddress              AS "emitter_company_address",
    emittercompanycontact              AS "emitter_company_contact",
    emittercompanymail                 AS "emitter_company_mail",
    emittercompanyphone                AS "emitter_company_phone",
    emitterisforeignship               AS "emitter_is_foreignship",
    emittercompanyominumber            AS "emitter_company_omi_number",
    emitterisprivateindividual         AS "emitter_is_private_individual",
    emitterpickupsite                  AS "emitter_pickup_site",
    emitterworksitename                AS "emitter_worksite_name",
    emitterworksiteaddress             AS "emitter_worksite_address",
    emitterworksitepostalcode          AS "emitter_worksite_postal_code",
    emitterworksitecity                AS "emitter_worksite_city",
    emitterworksiteinfos               AS "emitter_worksite_infos",
    emittedbyecoorganisme              AS "emitted_by_eco_organisme",
    emittedat                          AS "emitted_at",
    emittedby                          AS "emitted_by",
    signedat                           AS "signed_at",
    signedby                           AS "signed_by",
    signedbytransporter                AS "signed_by_transporter",
    sentat                             AS "sent_at",
    sentby                             AS "sent_by",
    transportercompanysiret            AS "transporter_company_siret",
    transportercompanyname             AS "transporter_company_name",
    transportercompanyaddress          AS "transporter_company_address",
    transporterdepartment              AS "transporter_department",
    transportercompanycontact          AS "transporter_company_contact",
    transportercompanymail             AS "transporter_company_mail",
    transportercompanyphone            AS "transporter_company_phone",
    transporternumberplate             AS "transporter_number_plate",
    transporterreceipt                 AS "transporter_receipt",
    transportervaliditylimit           AS "transporter_validity_limit",
    transportertransportmode           AS "transporter_transport_mode",
    transportercompanyvatnumber        AS "transporter_company_vat_number",
    transportercustominfo              AS "transporter_custom_info",
    transporterisexemptedofreceipt     AS "transporter_is_exempted_of_receipt",
    currenttransportersiret            AS "current_transporter_siret",
    nexttransportersiret               AS "next_transporter_siret",
    takenoverat                        AS "taken_over_at",
    takenoverby                        AS "taken_over_by",
    recipientcompanysiret              AS "recipient_company_siret",
    recipientcompanyname               AS "recipient_company_name",
    recipientcompanyaddress            AS "recipient_company_address",
    recipientcompanycontact            AS "recipient_company_contact",
    recipientcompanymail               AS "recipient_company_mail",
    recipientcompanyphone              AS "recipient_company_phone",
    recipientistempstorage             AS "recipient_is_temp_storage",
    recipientcap                       AS "recipient_cap",
    receivedat                         AS "received_at",
    receivedby                         AS "received_by",
    processedat                        AS "processed_at",
    processedby                        AS "processed_by",
    quantityreceived                   AS "quantity_received",
    quantityreceivedtype               AS "quantity_received_type",
    processingoperationdescription     AS "processing_operation_description",
    notraceability                     AS "no_traceability",
    isaccepted                         AS "is_accepted",
    nextdestinationcompanysiret        AS "next_destination_company_siret",
    nextdestinationcompanyname         AS "next_destination_company_name",
    nextdestinationcompanyaddress      AS "next_destination_company_address",
    nextdestinationcompanycountry      AS "next_destination_company_country",
    nextdestinationcompanycontact      AS "next_destination_company_contact",
    nextdestinationcompanymail         AS "next_destination_company_mail",
    nextdestinationcompanyphone        AS "next_destination_company_phone",
    nextdestinationcompanyvatnumber    AS "next_destination_company_vat_number",
    nextdestinationprocessingoperation AS "next_destination_processing_operation",
    brokercompanysiret                 AS "broker_company_siret",
    brokercompanyname                  AS "broker_company_name",
    brokercompanyaddress               AS "broker_company_address",
    brokerdepartment                   AS "broker_department",
    brokercompanycontact               AS "broker_company_contact",
    brokercompanymail                  AS "broker_company_mail",
    brokercompanyphone                 AS "broker_company_phone",
    brokerreceipt                      AS "broker_receipt",
    brokervaliditylimit                AS "broker_validity_limit",
    tradercompanysiret                 AS "trader_company_siret",
    tradercompanyname                  AS "trader_company_name",
    tradercompanyaddress               AS "trader_company_address",
    traderdepartment                   AS "trader_department",
    tradercompanycontact               AS "trader_company_contact",
    tradercompanymail                  AS "trader_company_mail",
    tradercompanyphone                 AS "trader_company_phone",
    traderreceipt                      AS "trader_receipt",
    tradervaliditylimit                AS "trader_validity_limit",
    ecoorganismesiret                  AS "eco_organisme_siret",
    ecoorganismename                   AS "eco_organisme_name",
    isimportedfrompaper                AS "is_imported_from_paper",
    forwardedinid                      AS "forwarded_in_id",
    replace(
        recipientprocessingoperation, ' ', ''
    )                                  AS "recipient_processing_operation",
    replace(
        processingoperationdone, ' ', ''
    )                                  AS "processing_operation_done"
FROM
    {{ source("raw_zone_trackdechets", "bsdd_raw") }}
